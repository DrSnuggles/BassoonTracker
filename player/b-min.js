/*BassoonTracker v0.3.8 by Steffest - build 2020-04-14 - Full source on https://github.com/steffest/BassoonTracker */
var BassoonTracker=function(){function I(e,t){function i(e){(e=0===e?e:e||o.index)<0&&(e=0),o.length<=e&&(e=o.length-1),o.index=e}var o={index:0,_am:!t,goto:function(e){i(e)},jump:function(e){this.goto(this.index+e)},readByte:function(e){i(e);var t=this.dataView.getInt8(this.index);return this.index++,t},writeByte:function(e,t){i(t),this.dataView.setInt8(this.index,e),this.index++},_e:function(e){i(e);var t=this.dataView.getUint8(this.index);return this.index++,t},_f:function(e,t){i(t),this.dataView.setUint8(this.index,e),this.index++},readUint:function(e){i(e);var t=this.dataView.getUint32(this.index,this._am);return this.index+=4,t},writeUint:function(e,t){i(t),this.dataView.setUint32(this.index,e,this._am),this.index+=4},readBytes:function(e,t){i(t);var a=new Uint8Array(e),n=this.index;(e+=n)>this.length&&(e=this.length);for(var r=0;n<e;++n)a.setUint8(r++,this.dataView.getUint8(n));return this.index=e,a},_v:function(e,t){i(t);var a=this.index,n=this.dataView,r="";for((e+=a)>this.length&&(e=this.length);a<e;++a){var o=n.getUint8(a);if(0==o)break;r+=String.fromCharCode(o)}return this.index=e,r},writeString:function(e,t){i(t);for(var a=this.dataView,n=e.length,r=0;r<n;r++)a.setUint8(this.index+r,e.charCodeAt(r));this.index+=n},_ah:function(e,t,a,n){i(n),a=a||0;var r=(e=e||"").length;(t=t||1)<r&&(e=e.substr(0,t)),o.writeString(e),o.fill(a,t-r)},_g:function(e){i(e);var t=this.dataView.getUint16(this.index,this._am);return this.index+=2,t},_h:function(e,t){i(t),this.dataView.setUint16(this.index,e,this._am),this.index+=2}};return o.readLong=o.readDWord=o.readUint,o.writeLong=o.writeDWord=o.writeUint,o.readShort=function(e,t){i(t);var a=this.dataView.getInt16(this.index,this._am);return this.index+=2,a},o.clear=function(e){o.fill(0,e)},o.fill=function(e,t){e=e||0,t=t||0;for(var a=0;a<t;a++)o.writeByte(e)},o.isEOF=function(e){return this.length-(e=e||0)<=this.index},e&&(o.buffer=e,o.dataView=new DataView(e),o.length=e.byteLength),o}var e,t,o,D=((t={}).useUrlParams=!0,t.useDropbox=!0,t.showInternalMenu=!0,t.useWebWorkers=!0,t.init=function(){"object"==typeof HostBridge&&((e=HostBridge).init(),"boolean"==typeof e.useUrlParams&&(t.useUrlParams=e.useUrlParams),"boolean"==typeof e.useDropbox&&(t.useDropbox=e.useDropboxs),"boolean"==typeof e.showInternalMenu&&(t.showInternalMenu=e.showInternalMenu),"boolean"==typeof e.useWebWorkers&&(t.useWebWorkers=e.useWebWorkers))},t.getBaseUrl=function(){return e&&e.getBaseUrl?e.getBaseUrl():"undefined"!=typeof Settings&&Settings.baseUrl||""},t.getRemoteUrl=function(){return e&&e.getRemoteUrl?e.getRemoteUrl():""},t.getVersionNumber=function(){return"undefined"!=typeof versionNumber?versionNumber:e&&e.getVersionNumber?e.getVersionNumber():"dev"},t.getBuildNumber=function(){return"undefined"!=typeof buildNumber?buildNumber:e&&e.getBuildNumber?e.getBuildNumber():(new Date).getTime()},t.putFile=function(e,t){},t),S={images:{},audio:{},json:{},arrayBuffer:{}},E=void 0,s=1,V=2,W=1,z=2,K=3,X=4,Z=5,_=7,Q=8,J=9,Y=10,$=12,G=13,ee=16,te=17,ae=24,ne=26,re=28,oe=29,l=33,a=36,u=46,ie=53,se=1,ue=2,c=1,f=2,p=3,A=1,F=2,_e={C1:{_b:856,_a:"C-1",tune:[907,900,894,887,881,875,868,862,856,850,844,838,832,826,820,814]},Cs1:{_b:808,_a:"C#1",tune:[856,850,844,838,832,826,820,814,808,802,796,791,785,779,774,768]},D1:{_b:762,_a:"D-1",tune:[808,802,796,791,785,779,774,768,762,757,752,746,741,736,730,725]},Ds1:{_b:720,_a:"D#1",tune:[762,757,752,746,741,736,730,725,720,715,709,704,699,694,689,684]},E1:{_b:678,_a:"E-1",tune:[720,715,709,704,699,694,689,684,678,674,670,665,660,655,651,646]},F1:{_b:640,_a:"F-1",tune:[678,675,670,665,660,655,651,646,640,637,632,628,623,619,614,610]},Fs1:{_b:604,_a:"F#1",tune:[640,636,632,628,623,619,614,610,604,601,597,592,588,584,580,575]},G1:{_b:570,_a:"G-1",tune:[604,601,597,592,588,584,580,575,570,567,563,559,555,551,547,543]},Gs1:{_b:538,_a:"G#1",tune:[570,567,563,559,555,551,547,543,538,535,532,528,524,520,516,513]},A1:{_b:508,_a:"A-1",tune:[538,535,532,528,524,520,516,513,508,505,502,498,495,491,487,484]},As1:{_b:480,_a:"A#1",tune:[508,505,502,498,494,491,487,484,480,477,474,470,467,463,460,457]},B1:{_b:453,_a:"B-1",tune:[480,477,474,470,467,463,460,457,453,450,447,444,441,437,434,431]},C2:{_b:428,_a:"C-2",tune:[453,450,447,444,441,437,434,431,428,425,422,419,416,413,410,407]},Cs2:{_b:404,_a:"C#2",tune:[428,425,422,419,416,413,410,407,404,401,398,395,392,390,387,384]},D2:{_b:381,_a:"D-2",tune:[404,401,398,395,392,390,387,384,381,379,376,373,370,368,365,363]},Ds2:{_b:360,_a:"D#2",tune:[381,379,376,373,370,368,365,363,360,357,355,352,350,347,345,342]},E2:{_b:339,_a:"E-2",tune:[360,357,355,352,350,347,345,342,339,337,335,332,330,328,325,323]},F2:{_b:320,_a:"F-2",tune:[339,337,335,332,330,328,325,323,320,318,316,314,312,309,307,305]},Fs2:{_b:302,_a:"F#2",tune:[320,318,316,314,312,309,307,305,302,300,298,296,294,292,290,288]},G2:{_b:285,_a:"G-2",tune:[302,300,298,296,294,292,290,288,285,284,282,280,278,276,274,272]},Gs2:{_b:269,_a:"G#2",tune:[285,284,282,280,278,276,274,272,269,268,266,264,262,260,258,256]},A2:{_b:254,_a:"A-2",tune:[269,268,266,264,262,260,258,256,254,253,251,249,247,245,244,242]},As2:{_b:240,_a:"A#2",tune:[254,253,251,249,247,245,244,242,240,239,237,235,233,232,230,228]},B2:{_b:226,_a:"B-2",tune:[240,238,237,235,233,232,230,228,226,225,224,222,220,219,217,216]},C3:{_b:214,_a:"C-3",tune:[226,225,223,222,220,219,217,216,214,213,211,209,208,206,205,204]},Cs3:{_b:202,_a:"C#3",tune:[214,212,211,209,208,206,205,203,202,201,199,198,196,195,193,192]},D3:{_b:190,_a:"D-3",tune:[202,200,199,198,196,195,193,192,190,189,188,187,185,184,183,181]},Ds3:{_b:180,_a:"D#3",tune:[190,189,188,187,185,184,183,181,180,179,177,176,175,174,172,171]},E3:{_b:170,_a:"E-3",tune:[180,179,177,176,175,174,172,171,170,169,167,166,165,164,163,161]},F3:{_b:160,_a:"F-3",tune:[170,169,167,166,165,164,163,161,160,159,158,157,156,155,154,152]},Fs3:{_b:151,_a:"F#3",tune:[160,159,158,157,156,155,154,152,151,150,149,148,147,146,145,144]},G3:{_b:143,_a:"G-3",tune:[151,150,149,148,147,146,145,144,143,142,141,140,139,138,137,136]},Gs3:{_b:135,_a:"G#3",tune:[143,142,141,140,139,138,137,136,135,134,133,132,131,130,129,128]},A3:{_b:127,_a:"A-3",tune:[135,134,133,132,131,130,129,128,127,126,125,125,124,123,122,121]},As3:{_b:120,_a:"A#3",tune:[127,126,125,125,123,123,122,121,120,119,118,118,117,116,115,114]},B3:{_b:113,_a:"B-3",tune:[120,119,118,118,117,116,115,114,113,113,112,111,110,109,109,108]}},le={None:{_a:"---"},C0:{_a:"C-0",_b:6848},Cs0:{_a:"C#0",_b:6464},D0:{_a:"D-0",_b:6096},Ds0:{_a:"D#0",_b:5760},E0:{_a:"E-0",_b:5424},F0:{_a:"F-0",_b:5120},Fs0:{_a:"F#0",_b:4832},G0:{_a:"G-0",_b:4560},Gs0:{_a:"G#0",_b:4304},A0:{_a:"A-0",_b:4064},As0:{_a:"A#0",_b:3840},B0:{_a:"B-0",_b:3624},C1:{_a:"C-1",_b:3424},Cs1:{_a:"C#1",_b:3232},D1:{_a:"D-1",_b:3048},Ds1:{_a:"D#1",_b:2880},E1:{_a:"E-1",_b:2712},F1:{_a:"F-1",_b:2560},Fs1:{_a:"F#1",_b:2416},G1:{_a:"G-1",_b:2280},Gs1:{_a:"G#1",_b:2152},A1:{_a:"A-1",_b:2032},As1:{_a:"A#1",_b:1920},B1:{_a:"B-1",_b:1812},C2:{_a:"C-2",_b:1712},Cs2:{_a:"C#2",_b:1616},D2:{_a:"D-2",_b:1524},Ds2:{_a:"D#2",_b:1440},E2:{_a:"E-2",_b:1356},F2:{_a:"F-2",_b:1280},Fs2:{_a:"F#2",_b:1208},G2:{_a:"G-2",_b:1140},Gs2:{_a:"G#2",_b:1076},A2:{_a:"A-2",_b:1016},As2:{_a:"A#2",_b:960},B2:{_a:"B-2",_b:906},C3:{_a:"C-3",_b:856},Cs3:{_a:"C#3",_b:808},D3:{_a:"D-3",_b:762},Ds3:{_a:"D#3",_b:720},E3:{_a:"E-3",_b:678},F3:{_a:"F-3",_b:640},Fs3:{_a:"F#3",_b:604},G3:{_a:"G-3",_b:570},Gs3:{_a:"G#3",_b:538},A3:{_a:"A-3",_b:508},As3:{_a:"A#3",_b:480},B3:{_a:"B-3",_b:453},C4:{_a:"C-4",_b:428},Cs4:{_a:"C#4",_b:404},D4:{_a:"D-4",_b:381},Ds4:{_a:"D#4",_b:360},E4:{_a:"E-4",_b:339},F4:{_a:"F-4",_b:320},Fs4:{_a:"F#4",_b:302},G4:{_a:"G-4",_b:285},Gs4:{_a:"G#4",_b:269},A4:{_a:"A-4",_b:254},As4:{_a:"A#4",_b:240},B4:{_a:"B-4",_b:226.5,_k:226},C5:{_a:"C-5",_b:214},Cs5:{_a:"C#5",_b:202},D5:{_a:"D-5",_b:190.5,_k:190},Ds5:{_a:"D#5",_b:180},E5:{_a:"E-5",_b:169.5,_k:170},F5:{_a:"F-5",_b:160},Fs5:{_a:"F#5",_b:151},G5:{_a:"G-5",_b:142.5,_k:143},Gs5:{_a:"G#5",_b:134.5,_k:135},A5:{_a:"A-5",_b:127},As5:{_a:"A#5",_b:120},B5:{_a:"B-5",_b:113.25,_k:113},C6:{_a:"C-6",_b:107},Cs6:{_a:"C#6",_b:101},D6:{_a:"D-6",_b:95.25,_k:95},Ds6:{_a:"D#6",_b:90},E6:{_a:"E-6",_b:84.75,_k:85},F6:{_a:"F-6",_b:80},Fs6:{_a:"F#6",_b:75.5,_k:75},G6:{_a:"G-6",_b:71.25,_k:71},Gs6:{_a:"G#6",_b:67.25,_k:67},A6:{_a:"A-6",_b:63.5,_k:63},As6:{_a:"A#6",_b:60},B6:{_a:"B-6",_b:56.625,_k:56},C7:{_a:"C-7",_b:53.5,_k:53},Cs7:{_a:"C#7",_b:50.5,_k:50},D7:{_a:"D-7",_b:47.625,_k:47},Ds7:{_a:"D#7",_b:45},E7:{_a:"E-7",_b:42.375,_k:42},F7:{_a:"F-7",_b:40},Fs7:{_a:"F#7",_b:37.75,_k:37},G7:{_a:"G-7",_b:35.625,_k:35},Gs7:{_a:"G#7",_b:33.625,_k:33},A7:{_a:"A-7",_b:31.75,_k:31},As7:{_a:"A#7",_b:30},B7:{_a:"B-7",_b:28.3125,_k:28},C8:{_a:"C-8",_b:26.75},Cs8:{_a:"C#8",_b:25.25},D8:{_a:"D-8",_b:23.8125},Ds8:{_a:"D#8",_b:22.5},E8:{_a:"E-8",_b:21.1875},F8:{_a:"F-8",_b:20},Fs8:{_a:"F#8",_b:18.875},G8:{_a:"G-8",_b:17.8125},Gs8:{_a:"G#8",_b:16.8125},A8:{_a:"A-8",_b:15.875},As8:{_a:"A#8",_b:15},B8:{_a:"B-8",_b:14.15625},C9:{_a:"C-9",_b:13.375},Cs9:{_a:"C#9",_b:12.625},D9:{_a:"D-9",_b:11.90625},Ds9:{_a:"D#9",_b:11.25},E9:{_a:"E-9",_b:10.59375},F9:{_a:"F-9",_b:10},Fs9:{_a:"F#9",_b:9.4375},G9:{_a:"G-9",_b:8.90625},Gs9:{_a:"G#9",_b:8.40625},A9:{_a:"A-9",_b:7.9375},As9:{_a:"A#9",_b:7.5},B9:{_a:"B-9",_b:7.078125},C10:{_a:"C-10",_b:6.6875},Cs10:{_a:"C#10",_b:6.3125},D10:{_a:"D-10",_b:5.953125},Ds10:{_a:"D#10",_b:5.625},E10:{_a:"E-10",_b:5.296875},F10:{_a:"F-10",_b:5},Fs10:{_a:"F#10",_b:4.71875},G10:{_a:"G-10",_b:4.453125},Gs10:{_a:"G#10",_b:4.203125},A10:{_a:"A-10",_b:3.96875},As10:{_a:"A#10",_b:3.75},B10:{_a:"B-10",_b:3.5390625},C11:{_a:"C-11",_b:3.34375},Cs11:{_a:"C#11",_b:3.15625},D11:{_a:"D-11",_b:2.9765625},Ds11:{_a:"D#11",_b:2.8125},E11:{_a:"E-11",_b:2.6484375},F11:{_a:"F-11",_b:2.5},Fs11:{_a:"F#11",_b:2.359375},G11:{_a:"G-11",_b:2.2265625},Gs11:{_a:"G#11",_b:2.1015625},A11:{_a:"A-11",_b:1.984375},As11:{_a:"A#11",_b:1.875},B11:{_a:"B-11",_b:1.76953125},OFF:{_a:"OFF",_b:0}},ce=145,fe=1,pe=2,de={unrollLoops:!1,unrollShortLoops:!1,sustainKeyboardNotes:!1,useHover:!0,keyboardTable:"qwerty",vubars:!0,stereoSeparation:f,_ac:!0},me=(o={},{on:function(e,t){var a=o[e];a||(o[e]=a=[]),a.push(t)},_o:function(e,t){var a=o[e];if(a){var n,r=a.length;for(n=0;n<r;n++)a[n](t,e)}}}),ve=function(){var A,o,r,i,S,V={};window.AudioContext=window.AudioContext||window.webkitAudioContext,window.OfflineAudioContext=window.OfflineAudioContext||window.webkitOfflineAudioContext;var F,B,I=[],s=f,a=0,D=[[],[],[]],E=0,M=4143.569,u={volume:!0,panning:!0,high:!0,mid:!0,low:!0,lowPass:!0,reverb:!0,distortion:!1};return AudioContext&&(A=new AudioContext),V.init=function(e){function t(){var e=FilterChain(u);e.output().connect(i),I.push(e)}if(e=e||A){var a;F=!!ve.context.createStereoPanner,B="undefined"!=typeof Editor,(r=(a=e).createGain()).gain.setValueAtTime(1,0),r.connect(a.destination),(o=a.createGain()).connect(r),V.setMasterVolume(1),(i=a.createBiquadFilter()).type="lowpass",i.frequency.setValueAtTime(2e4,0),i.connect(o),V.masterVolume=o,V.cutOffVolume=r,V.lowPassfilter=i;var n=we.getTrackCount();for(I=[],S=0;S<n;S++)t();V.filterChains=I,V.usePanning=F,me.on(_,function(e){void 0!==e.track&&I[e.track]&&I[e.track].volumeValue(e.mute?0:70)}),me.on(ae,function(e){for(S=I.length;S<e;S++)t();me._o(l,e),V.setStereoSeparation(s)}),me.on(re,function(e){V.setStereoSeparation()})}},V.enable=function(){r.gain.setValueAtTime(1,0),V.cutOff=!1},V.disable=function(){r.gain.setValueAtTime(0,0),V.cutOff=!0;D.forEach(function(e,t){e.forEach(function(e){e.gain.cancelScheduledValues(0),e.gain.setValueAtTime(0,0)}),D[t]=[]})},V.checkState=function(){A&&"suspended"===A.state&&A.resume&&A.resume()},V.playSample=function(e,t,a,n,r,o,i){var s;s=A,V.enable(),t=t||428,void 0===n&&(n=B?Editor.getCurrentTrack():0),o=o||A.currentTime,i===ce&&(a=0);var u,_,l,c=we._t(e),f=t,p=0;if(c){var d,m,v=0,h=0;a=void 0===a?100*c.sample.volume/64:a,p=(c.sample.panning||0)/128,we._j()?we._s?t-=c._af()/2:c._af()&&(t=V._ap(i,c._af())):c._af()&&(t=V._aq(t,c._af())),m=V._ao(t);var g=1;c.sample.data.length?(h=c.sample.data.length,r&&r.offset&&(h<=r.offset.value&&(r.offset.value=h-1),v=r.offset.value/s.sampleRate),d=s.createBuffer(1,h,s.sampleRate),g=m/s.sampleRate):(d=s.createBuffer(1,1,s.sampleRate),v=0);var b=d.getChannelData(0);for(S=0;S<h;S++)b[S]=c.sample.data[S];M=m;var y=s.createBufferSource();y.buffer=d;var T=s.createGain();if(T.gain.value=a/100,T.gain.setValueAtTime(a/100,o),c.sample.loop.enabled&&2<c.sample.loop.length&&(de.unrollLoops||(y.loop=!0,y.loopStart=c.sample.loop.start/s.sampleRate,y.loopEnd=(c.sample.loop.start+c.sample.loop.length)/s.sampleRate)),c._c.enabled||c._d.enabled||c.hasVibrato()){var k=c.noteOn(o),w=y;k.volume&&(y.connect(u=k.volume),w=u),k.panning&&(w.connect(_=k.panning),w=_),l=k.scheduled,w.connect(T)}else y.connect(T);var P=ve.context.createGain();if(P.gain.setValueAtTime(0,o),P.gain.linearRampToValueAtTime(1,o+.01),T.connect(P),F){var x=ve.context.createStereoPanner();x.pan.setValueAtTime(p,o),P.connect(x),x.connect(I[n].input())}else P.connect(I[n].input());y.playbackRate.value=g;y.start(o+0,v);var C={source:y,volume:T,panning:x,_c:u,_d:_,volumeFadeOut:P,startVolume:a,currentVolume:a,startPeriod:t,basePeriod:f,noteIndex:i,startPlaybackRate:g,sampleRate:m,_q:e,effects:r,track:n,time:o,scheduled:l};return D[E].push(T),me._o(G,C),C}return{}},V.playSilence=function(){if(A){var e=A.createBufferSource();e.connect(o),e.start()}},V.playRaw=function(e,t){if(A&&e&&e.length){var a;a=A.createBuffer(1,e.length,A.sampleRate);var n=t/audioContext.sampleRate,r=A.createBufferSource();r.buffer=a,r.loop=!0,r.playbackRate.value=n,r.connect(o),r.start()}},V.setStereoSeparation=function(e){var t,a=we.getTrackCount();if(we._j())t=0;else switch(s=e=e||s){case p:t=0,de.stereoSeparation=p;break;case c:t=1,de.stereoSeparation=c;break;default:t=.5,de.stereoSeparation=f}for(S=0;S<a;S++){var n=I[S];n&&n.panningValue(S%2==0?-t:t)}},V.getPrevSampleRate=function(){return M},V.context=A,V.getSemiToneFrom=function(e,t,a){var n=e;if(a&&(e=(e=V._afBasePeriod(e,a))||n),t){var r=he[e];if(r){var o=ye.indexOf(r._a),i=ye[o+t];if(i){var s=be[i];s&&(n=s._b,a&&(n=V._aq(n,a)))}}}return n},V.getNearestSemiTone=function(e,t){var a=8;if(t){var n=we._t(t);n&&n.sample.finetune&&(a+=n.sample.finetune)}var r=1e5,o=e;for(var i in _e)if(_e.hasOwnProperty(i)){var s=_e[i].tune[a],u=Math.abs(s-e);u<r&&(r=u,o=s)}return o},V._aq=function(e,t){var a=e,n=he[e];if(n&&n.tune){var r=8+t;0<=r&&r<n.tune.length&&(a=n.tune[r])}return a},V._ap=function(e,t){if(e===ce)return 1;var a=Te[e],n=0<t?Te[e+1]:Te[e-1];if(a&&n){var r=Math.abs(n._b-a._b)/127;return a._b-r*t}return a?a._b:1e5},V._afBasePeriod=function(e,t){var a=e,n=ge[t];return n&&(a=n[e]),a},V._ao=function(e){return we._j()?we._s?8363*Math.pow(2,(4608-e)/768):3579364/e:3546895/e},V.limitAmigaPeriod=function(e){return e=Math.max(e,113),e=Math.min(e,856)},V.setAmigaLowPassFilter=function(e,t){i.frequency.setValueAtTime(e?2e3:2e4,t)},V.setMasterVolume=function(e,t){e*=.7,o.gain.setValueAtTime(a,t=t||A.currentTime),o.gain.linearRampToValueAtTime(e,t+.02),a=e},V.slideMasterVolume=function(e,t){o.gain.linearRampToValueAtTime(e*=.7,t=t||A.currentTime),a=e},V.getLastMasterVolume=function(){return a/.7},V.clearScheduledNotesCache=function(){2<++E&&(E=0),D[E]=[]},V._r={sine:function(e,t,a,n){return e+Math.sin(t*a*.8)*n*1.7},saw:function(e,t,a,n){var r=1-Math.abs(t*a/7%1);return e+(r=(r=2*r-1)*n*-2)},square:function(e,t,a,n){var r=Math.sin(t*a)<=0?-1:1;return e+(r=r*n*2)},sawInverse:function(e,t,a,n){var r=Math.abs(t*a/7%1);return e+(r=(r=2*r-1)*n*-2)}},V}();!function(r,o,e){function i(a,e){if(!o[a]){if(!r[a]){var t="function"==typeof require&&require;if(!e&&t)return t(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+a+"'")}var n=o[a]={exports:{}};r[a][0].call(n.exports,function(e){var t=r[a][1][e];return i(t||e)},n,n.exports)}return o[a].exports}for(var s="function"==typeof require&&require,t=0;t<e.length;t++)i(e[t])}({1:[function(e,t,a){var n=e("./lib/WAAClock");t.exports=n,"undefined"!=typeof window&&(window.WAAClock=n)},{"./lib/WAAClock":2}],3:[function(e,t,a){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var a=[];return window.addEventListener("message",function(e){var t=e.source;t!==window&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),0<a.length&&a.shift()())},!0),function(e){a.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],2:[function(e,t,a){var n=e("__browserify_process");if("undefined"!=typeof window&&!AudioContext)throw new Error("This browser doesn't seem to support web audio API");function r(e,t,a){this.clock=e,this.func=a,this.repeatTime=null,this._n=o,this._m=i,this._armed=!1,this._latestTime=null,this._earliestTime=null,this.schedule(t)}var o=.1,i=.001;r.prototype.clear=function(){return this.clock._removeEvent(this),this},r.prototype.repeat=function(e){if(0===e)throw new Error("delay cannot be 0");return this.repeatTime=e,this},r.prototype.tolerance=function(e){return"number"==typeof e.late&&(this._n=e.late),"number"==typeof e.early&&(this._m=e.early),this._update(),this},r.prototype.isRepeated=function(){return null!==this.repeatTime},r.prototype.schedule=function(e){this._armed=!0,this.deadline=e,this._update(),this._earliestTime<=this.clock.context.currentTime&&(this.clock._removeEvent(this),this._execute())},r.prototype._execute=function(){this._armed=!1,this.clock.context.currentTime<this._latestTime?this.func(this):me&&me._o(u),!1===this._armed&&this.isRepeated()&&this.schedule(this.deadline+this.repeatTime)},r.prototype._update=function(){this._latestTime=this.deadline+this._n,this._earliestTime=this.deadline-this._m,this.clock._removeEvent(this),this.clock._insertEvent(this)};var s=t.exports=function(e,t){this._m=(t=t||{})._m||i,this._n=t._n||o,this.context=e,this._events=[],this._started=!1};s.prototype.setTimeout=function(e,t){return this._createEvent(e,this._absTime(t))},s.prototype.callbackAtTime=function(e,t){return this._createEvent(e,t)},s.prototype.timeStretch=function(a,e,n){var r=this.context.currentTime;return e.forEach(function(e){e.isRepeated()&&e.repeat(e.repeatTime*n);var t=a+n*(e.deadline-a);if(e.isRepeated())for(;t-e._m<=r;)t+=e.repeatTime;e.schedule(t)}),e},s.prototype.start=function(){if(!1===this._started){var e=this;this._started=!0,this._events=[];this._clockNode=this.context.createScriptProcessor(256,1,1),this._clockNode.connect(this.context.destination),this._clockNode.onaudioprocess=function(){n.nextTick(function(){e._tick()})}}},s.prototype.stop=function(){!0===this._started&&(this._started=!1,this._clockNode.disconnect())},s.prototype._tick=function(){for(var e=this._events.shift();e&&e._earliestTime<=this.context.currentTime;)e._execute(),e=this._events.shift();e&&this._events.unshift(e)},s.prototype._createEvent=function(e,t){var a=new r(this,t,e);return a.tolerance({late:this._n,early:this._m}),a},s.prototype._insertEvent=function(e){this._events.splice(this._indexByTime(e._earliestTime),0,e)},s.prototype._removeEvent=function(e){var t=this._events.indexOf(e);-1!==t&&this._events.splice(t,1)},s.prototype._indexByTime=function(e){for(var t,a=0,n=this._events.length;a<n;)t=Math.floor((a+n)/2),this._events[t]._earliestTime<e?a=t+1:n=t;return a},s.prototype._absTime=function(e){return e+this.context.currentTime},s.prototype._relTime=function(e){return e-this.context.currentTime}},{__browserify_process:3}]},{},[1]),FilterChain=function(e){function a(){var e,t,a,n;if(i=o,h&&(_=_||((e=A.createBiquadFilter()).type="highshelf",e.frequency.value=3200,e.gain.value=x,e),i.connect(_),i=_),g&&(l=l||((t=A.createBiquadFilter()).type="peaking",t.frequency.value=1e3,t.Q.value=.5,t.gain.value=P,t),i.connect(l),i=l),b&&(c=c||((a=A.createBiquadFilter()).type="lowshelf",a.frequency.value=320,a.gain.value=w,a),i.connect(c),i=c),y&&(f=f||((n=A.createBiquadFilter()).type="lowpass",n.frequency.value=5e3,n),i.connect(f),i=f),T&&(p=p||A.createConvolver(),(d=d||A.createGain()).gain.value=0,i.connect(d),d.connect(p),s=p),k){var r=A.createWaveShaper();r.curve=function(e){for(var t,a="number"==typeof e?e:50,n=new Float32Array(44100),r=Math.PI/180,o=0;o<44100;++o)n[o]=(3+a)*(t=2*o/44100-1)*20*r/(Math.PI+a*Math.abs(t));return n}(400),r.oversample="4x"}v&&(m=m||ve.context.createStereoPanner(),i.connect(m),i=m),u=u||A.createGain(),i.connect(u),s&&s.connect(u),i=u}var t={};e=e||{volume:!0,panning:!0};var o,i,s,u,_,l,c,f,p,d,m,n=(e={volume:!0,panning:!0}).volume,v=e.panning&&ve.context.createStereoPanner,h=e.high,g=e.mid,b=e.low,y=e.lowPass,T=e.reverb,k=e.distortion,w=0,P=0,x=0,r=70,C=0,A=ve.context;return(o=A.createGain()).gain.value=1,i=o,t.lowValue=function(e){if(b){if(void 0!==e){c.gain.value=20*(w=e)}return w}},t.midValue=function(e){if(g){if(void 0!==e){l.gain.value=20*(P=e)}return P}},t.highValue=function(e){if(h){if(void 0!==e){_.gain.value=20*(x=e)}return x}},t.lowPassFrequencyValue=function(e){if(y){var t=ve.context.sampleRate/2,a=Math.log(t/40)/Math.LN2,n=Math.pow(2,a*(e-1));f.frequency.value=t*n}},t.lowPassQualityValue=function(e){y&&(f.Q.value=30*e)},t.reverbValue=function(e){if(T){if(!p.buffer){var t=S.audio["data/reverb/sportcentre.m4a"];if(t)p.buffer=t;else B().load(["data/reverb/sportcentre.m4a"],V,function(){p.buffer=S.audio["data/reverb/sportcentre.m4a"]})}var a=parseInt(e)/100;d.gain.value=a*a}},t.volumeValue=function(e){if(n){if(void 0!==e){var t=(r=e)/100;u.gain.value=t*t}return r}},t.panningValue=function(e,t){if(v)return void 0!==e&&m.pan.setValueAtTime(C=e,t||ve.context.currentTime),C},t.setState=function(e,t){o.disconnect(),_&&_.disconnect(),l&&l.disconnect(),c&&c.disconnect(),f&&f.disconnect(),d&&d.disconnect(),m&&m.disconnect(),s=void 0,"high"===e&&(h=!!t),"mid"===e&&(g=!!t),"low"===e&&(b=!!t),"lowPass"===e&&(y=!!t),"reverb"===e&&(T=!!t),"panning"===e&&(v=!!t&&ve.context.createStereoPanner),a()},t.input=function(){return o},t.output=function(){return i},a(),t.volumeValue(r),t};var n,r,d,he={},ge={},be={},ye=[],Te=[],ke=[],we=function(){function e(s){s=s||0,(t=t||new WAAClock(ve.context)).start(),ve.enable(),E&&E.setStatus("Playing"),U=[],L=[];var u=(b=g.patterns[s]).length,_={},l=0,c=ve.context.currentTime+.1,f=.2,p=b,d=T;V=[],y=t.setTimeout(function(e){1<l&&y.repeat(f=1);var t=e.deadline+f;for(ve.clearScheduledNotesCache();c<t;){if(_.pause&&!we.autoPlay){if(!_.pasuseHandled){var a=c-ve.context.currentTime;0<a&&setTimeout(function(){R.pause(),R._x(6)},Math.round(1e3*a)+100),_.pasuseHandled=!0}return}if(R.setStateAtTime(c,{patternPos:l,songPos:d}),_.patternDelay){for(_.patternDelay--,F=0;F<P;F++)v(F,c);c+=O*q}else if(_=m(l,c,p,d),c+=O*q,u<=++l||_.patternBreak)if(_.positionBreak&&_._ab==d||(U=[],L=[]),l=0,we.getPlayType()==se){var n=_.positionBreak?_._ab:++d;g.length<=n&&(n=g._ak?g._ak-1:0,me._o(ie)),g.length<=n&&(n=0),(p=g.patterns[s=g.patternTable[d=n]])||(p=h(),g.patterns[s]=p),u=p.length,_.patternBreak&&p.length<(l=_._y||0)&&(l=0)}else _.patternBreak&&x<(l=_._y||0)&&(l=0)}for(F=0;F<P;F++){var r=N[F];if(r&&r.time&&r.scheduled){var o=R._t(r._q);if(r.scheduled.volume&&r.scheduled.volume<=c+f){var i=o.scheduleEnvelopeLoop(r._c,r.scheduled.volume,2);r.scheduled.volume+=i}r.scheduled.panning&&r.scheduled.panning<=c+f&&(i=o.scheduleEnvelopeLoop(r._d,r.scheduled.panning,2),r.scheduled.panning+=i)}}},.01).repeat(f).tolerance({early:.1})}function m(e,t,a,n){for(var r,o=(a=a||b)[e],i=P,s={},u=0;u<i;u++)(_=o[u])&&_.effect&&15===_.effect&&(_._i<=32?(we._x(_._i),0===_._i&&(s.pause=!0)):we.setBPM(_._i));for(u=0;u<i;u++){var _=o[u];if(_){var l={position:n,step:e},c=t;if(S)c+=(Math.random()*S*2-S)/1e3;(r=f(_,u,c,l)).patternBreak&&(s.patternBreak=!0,s._y=r._y||0),r.positionBreak&&(s.positionBreak=!0,s._y=r._y||0,s._ab=r._ab||0),r.patternDelay&&(s.patternDelay=r.patternDelay)}}for(u=0;u<i;u++)v(u,t);return s}function f(e,t,a,n){var r=100,o={},i=e._u,s=e._b,u=e.index;s&&!i&&(i=N[t].currentInstrument,r="number"==typeof N[t].currentVolume?N[t].currentVolume:r,de._ac&&i&&H[t].offset&&H[t].offset._u===i&&(o.offset=H[t].offset)),"number"==typeof e._u&&(B=R._t(e._u))&&(r=B.sample.volume/64*100,de._ac&&(H[t].offset=H[t].offset||{},H[t].offset.value=0,H[t].offset._u=e._u));var _=r,l=!0;if("number"==typeof i&&(B=R._t(i)),u&&R._j())if(97===u&&(u=ce),u===ce){var c=B||R._t(N[t].currentInstrument);r=_=c?c.noteOff(a,N[t]):0,l=!1}else if(B&&(B.setSampleForNoteIndex(u),B.sample.relativeNote&&(u+=B.sample.relativeNote)),R._s)s=7680-64*(u-1);else{var f=Te[u];f&&(s=f._b)}var p,d,m=e._i,v={};if(e.volumeEffect&&R._j()){var h=e.volumeEffect;if(p=h>>4,d=15&h,15<h&&h<=80)o.volume={value:r=_=(h-16)/64*100};else switch(p){case 6:o.fade={value:-1*d*100/64};break;case 7:o.fade={value:100*d/64};break;case 8:o.fade={value:100*-d/64,fine:!0};break;case 9:o.fade={value:100*d/64,fine:!0};break;case 10:case 11:break;case 12:o.panning={value:17*(h-192),slide:!1};break;case 13:o.panning={value:h,slide:!0}}}switch(e.effect){case 0:if(m){p=m>>4,d=15&m;var g=0;if(B=B||R._t(N[t].currentInstrument),R._j()){if(B){var b=u||N[t].noteIndex,y=B._an(b,!0);u===ce?o.arpeggio=H[t].arpeggio:(o.arpeggio={root:y,interval1:y-B._an(b+p,!0),interval2:y-B._an(b+d,!0),step:1},H[t].arpeggio=o.arpeggio)}}else y=s||N[t].startPeriod,B&&(g=B._af())&&(y=ve._aq(y,g)),o.arpeggio={root:y,interval1:y-ve.getSemiToneFrom(y,p,g),interval2:y-ve.getSemiToneFrom(y,d,g),step:1}}e._u&&(o.volume={value:r});break;case 1:m*=-1,R._j()&&!m&&H[t].slideUp&&(m=H[t].slideUp.value),o.slide={value:m},H[t].slideUp=o.slide;break;case 2:R._j()&&!m&&H[t].slideDown&&(m=H[t].slideDown.value),o.slide={value:m},H[t].slideDown=o.slide;break;case 3:l=!1;var T=s;if(R._j()&&u===ce&&(T=0),N[t].currentInstrument&&(i=N[t].currentInstrument),T&&i)(B=R._t(i))&&B._af()&&(T=R._j()?B._an(u,!0):ve._aq(T,B._af()));(P=H[t].slide)&&(m=m||P.value),o.slide={value:m,target:T=T||H[t].defaultSlideTarget,canUseGlissando:!0,resetVolume:!!e._u,volume:r},H[t].slide=o.slide,e._u&&(o.volume={value:r});break;case 4:e._u&&(N[t].startVolume&&(o.volume={value:_}),N[t]._l=0);var k=(p=m>>4)*O/64,w=H[t]._p;0==p&&w&&(k=w.freq),0==(d=15&m)&&w&&(d=w.amplitude),o._p={amplitude:d,freq:k},H[t]._p=o._p;break;case 5:var P;l=!1,(T=s)&&i&&(B=R._t(i))&&B._af()&&(T=R._j()?ve._ap(u,B._af()):ve._aq(T,B._af())),m=1,(P=H[t].slide)&&(T=T||(P.target||0),m=P.value),o.slide={value:m,target:T},H[t].slide=o.slide,e._u&&(o.volume={value:r}),(m=e._i)&&(e._i<16?m*=-1:m=e._i>>4,o.fade={value:m=100*m/64,resetOnStep:!!e._u},H[t].fade=o.fade);break;case 6:e._u&&(N[t].startVolume&&(o.volume={value:_}),N[t]._l=0),e._i?(e._i<16?m*=-1:m=15&e._i,o.fade={value:m=100*m/64},H[t].fade=o.fade):we._j()&&H[t].fade&&(o.fade=H[t].fade),H[t]._p&&(o._p=H[t]._p);break;case 7:s&&!e._u&&(N[t].startVolume&&(o.volume={value:_}),N[t].tremoloTimer=0);var x=d=15&m,C=(k=(p=m>>4)*O/64,H[t].tremolo);0==p&&C&&(k=C.freq),0==d&&C&&(x=C.amplitude),o.tremolo={amplitude:x,freq:k},H[t].tremolo=o.tremolo;break;case 8:o.panning={value:m,slide:!1};break;case 9:!(m<<=8)&&H[t].offset&&(m=H[t].offset.stepValue||H[t].offset.value||0);var A=m;de._ac&&!e._u&&H[t].offset&&(m+=H[t].offset.value),o.offset={value:m,stepValue:A},H[t].offset=H[t].offset||{},H[t].offset.value=o.offset.value,H[t].offset.stepValue=o.offset.stepValue,de._ac&&(e._u&&(H[t].offset._u=e._u),s&&(H[t].offset.value+=A)),e._u&&(o.volume={value:r});break;case 10:if(e._i<16?m*=-1:m=e._i>>4,m=100*m/64,!e._i){var S=H[t].fade;S&&(m=S.value)}o.fade={value:m,resetOnStep:!!e._u},R._j()&&(H[t].fade=o.fade);break;case 11:we.autoPlay||(v.patternBreak=!0,v.positionBreak=!0,v._ab=e._i,v._y=0);break;case 12:o.volume={value:_=e._i/64*100};break;case 13:v.patternBreak=!0,v._y=10*(p=m>>4)+(d=15&m);break;case 14:var V=m>>4,F=15&m;switch(V){case 0:R._j()||ve.setAmigaLowPassFilter(!F,a);break;case 1:!(F*=-1)&&H[t].fineSlide&&(F=H[t].fineSlide.value),o.slide={value:F,fine:!0},H[t].fineSlide=o.slide;break;case 2:!F&&H[t].fineSlide&&(F=H[t].fineSlide.value),o.slide={value:F,fine:!0},H[t].fineSlide=o.slide;break;case 3:H[t].glissando=!!F;break;case 4:switch(F){case 1:G=ve._r.saw;break;case 2:G=ve._r.square;break;case 3:case 4:G=ve._r.sine;break;case 5:G=ve._r.saw;break;case 6:G=ve._r.square;break;case 7:default:G=ve._r.sine}break;case 5:if(i){var B=R._t(i);o.fineTune={original:B._af(),_u:B},B.setFineTune(F)}break;case 6:F?(L[t]=L[t]||0,L[t]<F?(L[t]++,v.patternBreak=!0,v.positionBreak=!0,v._ab=n.position,v._y=U[t]||0):L[t]=0):U[t]=n.step;break;case 7:switch(F){case 1:j=ve._r.saw;break;case 2:j=ve._r.square;break;case 3:case 4:j=ve._r.sine;break;case 5:j=ve._r.saw;break;case 6:j=ve._r.square;break;case 7:default:j=ve._r.sine}break;case 8:break;case 9:F&&(o.reTrigger={value:F});break;case 10:o.fade={value:F=100*F/64,fine:!0};break;case 11:o.fade={value:-(F=100*F/64),fine:!0};break;case 12:F?F<O&&(o.cutNote={value:F}):l=!1;break;case 13:F&&(F<O?a+=q*F:l=!1);break;case 14:v.patternDelay=F}break;case 15:e._i<=32?we._x(e._i,a):we.setBPM(e._i);break;case 16:m=Math.min(m,64),ve.setMasterVolume(m/64,a);break;case 17:p=m>>4,d=15&m;var I=64*ve.getLastMasterVolume(),D=0;if(p){var E=a+p*q;D=p*(O-1)}else d&&(E=a+d*q,D=-d*(O-1));D&&(m=(I+D)/64,m=Math.max(0,m),m=Math.min(1,m),ve.slideMasterVolume(m,E));break;case 20:R._j()&&(r=_=(c=B||R._t(N[t].currentInstrument))?c.noteOff(a,N[t]):0,l=!1);break;case 21:case 25:break;case 27:o.reTrigger={value:e._i}}return l&&i&&s&&(M(t,a),N[t]={},B&&(N[t]=B.play(u,s,_,t,o,a)),H[t].defaultSlideTarget=N[t].startPeriod),i&&(N[t].currentInstrument=i,o.fineTune&&o.fineTune._u&&o.fineTune._u.setFineTune(o.fineTune.original||0)),B&&B.hasVibrato()&&(N[t]._ar=!0),N[t].effects=o,N[t].note=e,v}function M(e,t){try{if(N[e].source){var a=N[e].volume.gain;a.setValueAtTime(N[e].currentVolume/100,t-.002),a.linearRampToValueAtTime(0,t),N[e].source.stop(t+.02)}}catch(e){}}function C(e,t){var a=R._t(e._q);if(a){var n=-a._p.rate/40,r=a._p.depth/8;if(R._s&&(r*=4),e._l=e._l||0,a._p.sweep&&e._l<a._p.sweep)r*=1-(a._p.sweep-e._l)/a._p.sweep;var o=a._ae()(t,e._l,n,r);return e._l++,o}return t}function v(e,t){var a=N[e],n=a.effects;if(a&&n){var r,o=!1;if(a.startVibratoTimer=a._l||0,a.resetPeriodOnStep&&a.source)R.setPeriodAtTime(a,c=a.currentPeriod||a.startPeriod,t),a.resetPeriodOnStep=!1;if(n.volume){var i=n.volume.value;a.volume&&a.volume.gain.setValueAtTime(i/100,t),a.currentVolume=i}if(n.panning&&(255===(r=n.panning.value)&&(r=254),a.panning&&a.panning.pan.setValueAtTime((r-127)/127,t)),n.fade){var s;r=n.fade.value;var u=1;s=n.fade.resetOnStep?a.startVolume:a.currentVolume;var _=O;n.fade.fine&&(u=0,_=1);for(var l=u;l<_;l++)a.volume&&(a.volume.gain.setValueAtTime(s/100,t+l*q),s+=r,s=Math.max(s,0),s=Math.min(s,100));a.currentVolume=s}if(n.slide&&a.source){var c=m=a.currentPeriod||a.startPeriod;_=O;n.slide.fine&&(_=2);var f=n.slide.value;if(R._j()&&R._s&&(f=4*n.slide.value),r=Math.abs(f),R._j()&&n.slide.resetVolume&&(a.volumeFadeOut||a._c)){var p=R._t(a._q);p&&p.resetVolume(t,a)}a._l=a.startVibratoTimer;for(l=1;l<_;l++){n.slide.target?(H[e].defaultSlideTarget=n.slide.target,c<n.slide.target?n.slide.target<(c+=r)&&(c=n.slide.target):(c-=r)<n.slide.target&&(c=n.slide.target)):(c+=f,H[e].defaultSlideTarget&&(H[e].defaultSlideTarget+=f)),R._j()||(c=ve.limitAmigaPeriod(c));var d=c;n.slide.canUseGlissando&&H[e].glissando&&(d=ve.getNearestSemiTone(c,a._q)),d!==a.currentPeriod&&(a.currentPeriod=c,a._ar&&R._j()&&(c=C(a,c),o=!0),R.setPeriodAtTime(a,d,t+l*q))}}if(n.arpeggio&&a.source){var m=a.currentPeriod||a.startPeriod;a.resetPeriodOnStep=!0,a._l=a.startVibratoTimer;for(l=0;l<O;l++){var v=l%3;0==v&&(c=m),1==v&&n.arpeggio.interval1&&(c=m-n.arpeggio.interval1),2==v&&n.arpeggio.interval2&&(c=m-n.arpeggio.interval2),a._ar&&R._j()&&(c=C(a,c),o=!0),R.setPeriodAtTime(a,c,t+l*q)}}if(n._p||a._ar&&!o){n._p=n._p||{freq:0,amplitude:0};var h=n._p.freq,g=n._p.amplitude;if(R._j()&&R._s&&(g*=4),a._l=a._l||0,a.source){a.resetPeriodOnStep=!0,m=a.currentPeriod||a.startPeriod,a._l=a.startVibratoTimer;for(l=0;l<O;l++)c=G(m,a._l,h,g),a._ar&&R._j()?(c=C(a,c),o=!0):a._l++,R.setPeriodAtTime(a,c,t+l*q)}}if(n.tremolo){h=n.tremolo.freq,g=n.tremolo.amplitude;if(a.tremoloTimer=a.tremoloTimer||0,a.volume){var b=a.startVolume;for(l=0;l<O;l++)(b=j(b,a.tremoloTimer,h,g))<0&&(b=0),100<b&&(b=100),a.volume.gain.setValueAtTime(b/100,t+l*q),a.currentVolume=b,a.tremoloTimer++}}if(n.cutNote&&(a.volume&&a.volume.gain.setValueAtTime(0,t+n.cutNote.value*q),a.currentVolume=0),n.reTrigger){var y=a._q,T=a.startPeriod;i=a.startVolume;for(var k=a.noteIndex,w=n.reTrigger.value||1,P=w;P<O;){var x=t+P*q;M(e,x),N[e]=ve.playSample(y,T,i,e,n,x,k),P+=w}}}}function s(){E&&E.setInfo(g.title),g.channels&&R.setTrackCount(g.channels),k=a=r=n=void 0,R.setCurrentSongPosition(0),R._ad(0),R.setCurrentInstrumentIndex(1),R.clearEffectCache(),me._o(ne,g),me._o(ee,g)}function u(){R._x(6),R.setBPM(125),j=G=ve._r.sine,H=[],N=[];for(var e=0;e<P;e++)N.push({}),H.push({});R._s=!1,R._as(fe),ve.setMasterVolume(1),ve.setAmigaLowPassFilter(!1,0)}function h(){for(var e=[],t=0;t<x;t++){var a,n=[];for(a=0;a<P;a++)n.push(Ce());e.push(n)}return e}for(var t,g,r,a,n,b,G,j,y,R={},o=!1,i=!1,_=[],l=1,c=0,p=0,d=se,T=0,k=0,w=125,O=6,q=2.5/w,P=4,x=64,A=fe,S=0,N=[],H=[],V=[],U=[],L=[],F=0;F<P;F++)N.push({}),H.push({});R.init=function(e){for(var t=-8;t<8;t++)ge[t]={};for(var a in _e)if(_e.hasOwnProperty(a)){var n=_e[a];if(ye.push((be[(he[n._b]=n)._a]=n)._a),n.tune)for(t=-8;t<8;t++){ge[t][n.tune[t+8]]=n._b}}var r=0;for(a in le)if(le.hasOwnProperty(a)){var o=le[a];o._b||(o._b=1),Te.push(o),ke[o._b]=r,o._k&&(ke[o._k]=r),r++}e&&(ve.init(),e.plugin&&E.initPlugin(e))},R.setCurrentInstrumentIndex=function(e){if(g._us[e])r!=(l=e)&&me._o(W,l),r=l;else if(e<=R.getMaxInstruments()){for(var t=g._us.length,a=e;t<=a;t++)R.setInstrument(t,xe());var n=[];for(t=1;t<=a;t++){n.push({label:t+" "+(g._us[t]||{_a:""})._a,data:t}),me._o(oe,n)}r!=(l=e)&&me._o(W,l),r=l}},R.getCurrentInstrumentIndex=function(){return l},R.getCurrentInstrument=function(){return _[l]},R.getMaxInstruments=function(){return R._j()?128:31},R.setCurrentPattern=function(e){(b=g.patterns[c=e])||(b=h(),g.patterns[c]=b),x=b.length,a!=c&&me._o(z,c),a=c},R.getCurrentPattern=function(){return c},R.getCurrentPatternData=function(){return b},R.updatePatternTable=function(e,t){me._o(X,g.patternTable[e]=t),e==T&&(a=void 0,we.setCurrentPattern(t))},R._ad=function(e){n!=(p=e)&&me._o(K,{current:p,prev:n}),n=p},R.getCurrentPatternPos=function(){return p},R.moveCurrentPatternPos=function(e){var t=p+e,a=x-1;t<0&&(t=a),a<t&&(t=0),R._ad(t)},R.getCurrentSongPosition=function(){return T},R.setCurrentSongPosition=function(e,t){(T=e)!=k&&(me._o(Y,T),g.patternTable&&R.setCurrentPattern(g.patternTable[T]),k=T,t&&R.isPlaying()&&(R.stop(),R.togglePlay()))},R.addToPatternTable=function(e,t){void 0===e&&(e=g.length),t=t||0,e==g.length&&(g.patternTable[e]=t,g.length++),me._o(ee,g),me._o(X)},R.removeFromPatternTable=function(e){g.length<2||(void 0===e&&(e=g.length-1),e==g.length-1&&(g.patternTable[e]=0,g.length--),T==g.length&&R.setCurrentSongPosition(T-1),me._o(ee,g),me._o(X))},R.setPlayType=function(e){me._o(J,d=e)},R.getPlayType=function(){return d},R.playSong=function(){R.stop(),ve.checkState(),R.setPlayType(se),i=!0,e(c),me._o(Q,i)},R.playPattern=function(){R.stop(),ve.checkState(),p=0,R.setPlayType(ue),i=!0,e(c),me._o(Q,i)},R.stop=function(){t&&t.stop(),ve.disable(),ve.setMasterVolume(1),E&&(E.setStatus("Ready"),Input.clearInputNotes()),R.clearEffectCache();for(var e=0;e<P;e++)if(N[e].source)try{N[e].source.stop()}catch(e){}me._o(Q,i=!1)},R.pause=function(){t&&t.stop(),me._o(Q,i=!1)},R.togglePlay=function(){R.isPlaying()?R.stop():d==ue?R.playPattern():R.playSong()},R.getProperties=function(){return{ticksPerStep:O,tickTime:q}},R.playPatternStep=m,R.cutNote=M,R.setBPM=function(e){t&&t.timeStretch(ve.context.currentTime,[y],w/e),q=2.5/(w=e),me._o($,w)},R.getBPM=function(){return w},R._x=function(e){O=e},R.getAmigaSpeed=function(){return O},R.getSwing=function(){return S},R.setSwing=function(e){S=e},R.getPatternLength=function(){return x},R.setPatternLength=function(e){var t=g.patterns[c].length;if(t!==(x=e)){if(t<x)for(var a=t;a<x;a++){var n,r=[];for(n=0;n<P;n++)r.push(Ce());g.patterns[c].push(r)}else g.patterns[c]=g.patterns[c].splice(0,x),x<=p&&R._ad(x-1);me._o(z,c)}},R.getTrackCount=function(){return P},R.setTrackCount=function(e){P=e;for(var t=N.length;t<P;t++)N.push({});for(t=H.length;t<P;t++)H.push({});me._o(ae,P)},R.toggleRecord=function(){R.stop(),me._o(Z,o=!o)},R.isPlaying=function(){return i},R.isRecording=function(){return o},R.setStateAtTime=function(e,t){V.push({time:e,state:t})},R.getStateAtTime=function(e){for(var t=void 0,a=0,n=V.length;a<n;a++){if(!(V[0].time<e))return t;t=V.shift().state}return t},R.getTimeStates=function(){return V},R.setPeriodAtTime=function(e,t,a){if(t=Math.max(t,1),R._j()&&R._s)var n=8363*Math.pow(2,(4608-t)/768)/ve.context.sampleRate;else n=e.startPeriod/t,n*=e.startPlaybackRate;e.source.playbackRate.setValueAtTime(n,a),e.source.playbackRate.setValueAtTime(n,a+.005)},R.load=function(i,s,u){(i=i||"demomods/StardustMemories.mod").indexOf("://")<0&&0!==i.indexOf("/")&&(i=D.getBaseUrl()+i),E&&(E.setInfo(""),E.setLoading());function t(e){R.processFile(e,_,function(e){if(E&&E.setStatus("Ready"),e){var t="",a="";if("string"==typeof i){if(0<i.indexOf("modarchive.org")){var n=i.split("moduleid=")[1];g.file_a=n.split("#")[1]||n,a="modArchive",t="https://modarchive.org/index.php?request=view_by_moduleid&query="+(n=(n=n.split("#")[0]).split("&")[0]),me._o(ee,g)}0<i.indexOf("modules.pl")&&(n=i.split("modules.pl/")[1],g.file_a=n.split("#")[1]||n,a="modules.pl",t="http://www.modules.pl/?id=module&mod="+(n=(n=n.split("#")[0]).split("&")[0]),me._o(ee,g))}E&&E.setInfo(g.title,a,t)}if(E&&e&&!s){var r=window.location.path_a,o=r.substring(r.lastIndexOf("/")+1);window.history.pushState&&window.history.pushState({},_,o+"?file="+encodeURIComponent(i))}e&&B(s),u&&u()})}var e,a,n,_="";"string"==typeof i?(_=i.substr(i.lastIndexOf("/")+1),e=i,a=function(e){t(e)},(n=new XMLHttpRequest).open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(e){var t=n.response;t&&200===n.status?a&&a(t):"undefined"!=typeof Editor&&a&&a(!1)},n.send(null)):(_=i._a||"",s=!0,t(i.buffer||i))};var B=function(e){var t=function(e){if(window.location.getParameter)return window.location.getParameter(e);if(location.search)for(var t=location.search.substring(1).split("&"),a=0;a<t.length;a++){var n=t[a].split("=");if(n[0]&&n[0]==e)return n[1]||!0}}("autoplay");we.autoPlay&&(t="1"),!E&&e&&(t="1"),"true"!=t&&"1"!=t||we.playSong()};return R.handleUpload=function(e){if(e.length){var t=e[0],a=new FileReader;a.onload=function(){R.processFile(a.result,t._a,function(e){E&&E.setStatus("Ready")})},a.readAsArrayBuffer(t)}},R.processFile=function(e,t,a){var n=!1,r=new I(e,!0),o=Pe.detect(r,t);if(o&&"ZIP"==o._a){if(E&&E.setStatus("Extracting Zip file",!0),"undefined"==typeof UZIP)return!1;var i=UZIP.parse(e);for(var t in i){R.processFile(i[t].buffer,t,a);break}}o.isMod&&o.loader&&(n=!0,R.isPlaying()&&R.stop(),u(),(g=o.loader().load(r,t)).file_a=t,s()),o.isSample&&"undefined"!=typeof Editor&&Editor.importSample(r,t),a&&a(n)},R.getSong=function(){return g},R._ts=function(){return _},R._t=function(e){return _[e]},R.setInstrument=function(e,t){_[t._q=e]=t},R.clearEffectCache=function(){H=[];for(var e=0;e<P;e++)H.push({})},R.clearInstruments=function(e){if(g){var t=[],a=e||g._us.length-1;for(_=[],F=1;F<=a;F++)R.setInstrument(F,xe()),t.push({label:F+" ",data:F});g._us=_,me._o(oe,t),me._o(W,l)}},R._as=function(e){A=e,de._ac=!R._j(),me._o(re,e)},R.getTrackerMode=function(){return A},R._j=function(){return A===pe},R.new=function(){u(),g={patterns:[],_us:[]},R.clearInstruments(31),g.typeId="M.K.",g.title="new song",g.length=1,g._ak=0,g.patterns.push(h());for(var e=[],t=0;t<128;++t)e[t]=0;g.patternTable=e,s()},R.clearInstrument=function(){_[l]=xe(),me._o(W,l),me._o(te,l)},R.getFileName=function(){return g.file_a||(g.title?g.title.replace(/ /g,"-").replace(/\W/g,"")+".mod":"new.mod")},R._s=!0,R}(),B=function(){var o={load:function(e,t,a){o.type=t||s,o.loadCount=0,o.max=e.length,o.next=a;for(var n=0,r=e.length;n<r;n++)i(e[n])}},i=function(t){if(o.type==s){var e=new Image;e.onload=function(){S.images[t]=this,++o.loadCount==o.max&&o.next&&o.next()},e.onerror=function(){alert("BufferLoader: XHR error")},e.src=t}if(o.type==V){var a=new XMLHttpRequest;a.responseType="arraybuffer",a.open("GET",t,!0),a.onload=function(){ve.context.decodeAudioData(a.response,function(e){e?(S.audio[t]=e,++o.loadCount==o.max&&o.next&&o.next()):alert("error decoding file data: "+t)},function(e){})},a.onerror=function(){alert("BufferLoader: XHR error")},a.send()}};return o},Pe=((n={}).get=function(e,t){n.ajax({url:e,success:function(e){t(e)},error:function(e){t(void 0,e)}})},n.json=function(e,t){void 0===t&&(t=function(){}),n.ajax({url:e,cache:!1,datatype:"json",headers:[{key:"Accept",value:"application/json"}],success:function(e){t(e)},error:function(e){t(void 0,e)}})},n.html=function(e,t){n.ajax({url:e,cache:!1,datatype:"html",success:function(e){t(e)},error:function(e){t(void 0,e)}})},n.ajax=function(t){var a=new XMLHttpRequest;t.error=t.error||function(){t.success(!1)},"jsonp"===t.datatype&&t.error(a);var e=t.url;if("boolean"==typeof t.cache&&!t.cache&&D.useUrlParams){var n=(new Date).getTime();e+=0<e.indexOf("?")?"&r="+n:"?r="+n}var r=t.method||"GET";a.onreadystatechange=function(){if(!(a.readyState<4)&&4===a.readyState)if(200!==a.status&&201!==a.status)t.error(a);else{var e=a.responseText;"json"===t.datatype&&(e=JSON.parse(e)),"html"===t.datatype&&((e=document.createElement("div")).innerHTML=a.responseText),t.success(e)}},a.ontimeout=function(e){},a.open(r,e,!0),a.timeout=t.timeout||3e4,t.headers&&t.headers.forEach(function(e){a.setRequestHeader(e.key,e.value)});var o=t.data||"";"POST"===r&&t.data&&"form"===t.datatype&&a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(o)},d={unknown:{_a:"UNKNOWN"},unsupported:{_a:"UNSUPPORTED"},mod_ProTracker:{_a:"PROTRACKER",isMod:!0,loader:function(){return i()}},mod_SoundTracker:{_a:"SOUNDTRACKER",isMod:!0,loader:function(){return m()}},mod_FastTracker:{_a:"FASTTRACKER",isMod:!0,loader:function(){return v()}},sample:{_a:"SAMPLE",isSample:!0},zip:{_a:"ZIP"}},(r={}).detect=function(r,e){function o(e){return e<128}var i=r.length;if("PK"==r._v(2,0))return d.zip;var t="";if("Extended Module: "==(t=r._v(17,0)))return d.mod_FastTracker;if(1100<i&&(t=r._v(4,1080)),"M.K."==t)return d.mod_ProTracker;if("M!K!"==t)return d.mod_ProTracker;if("M&K!"==t)return d.mod_ProTracker;if("FLT4"==t)return d.mod_ProTracker;if("2CHN"==t)return d.mod_ProTracker;if("6CHN"==t)return d.mod_ProTracker;if("8CHN"==t)return d.mod_ProTracker;if("10CH"==t)return d.mod_ProTracker;if("12CH"==t)return d.mod_ProTracker;if("14CH"==t)return d.mod_ProTracker;if("16CH"==t)return d.mod_ProTracker;if("18CH"==t)return d.mod_ProTracker;if("20CH"==t)return d.mod_ProTracker;if("22CH"==t)return d.mod_ProTracker;if("24CH"==t)return d.mod_ProTracker;if("26CH"==t)return d.mod_ProTracker;if("28CH"==t)return d.mod_ProTracker;if("30CH"==t)return d.mod_ProTracker;if("32CH"==t)return d.mod_ProTracker;var a="";return e&&4<e.length&&(a=e.substr(e.length-4)),".wav"==(a=a.toLowerCase())||".mp3"==a||".iff"==a?d.sample:".zip"==a?d.zip:e&&0<=e.indexOf(".")&&1624<i&&function(){r.goto(0);for(var e=0;e<20;e++)if(!o(r.readByte()))return;for(var t=0,a=0,n=0;n<15;n++){for(e=0;e<22;e++)if(!o(r.readByte()))return;if(r.jump(-22),"st-"==r._v(22).toLowerCase().substr(0,3)&&(a+=10),20<a)return 1;t+=r._g(),r.jump(6)}return!(i<2*t+1624)}()?d.mod_SoundTracker:d.sample},r),i=function(){var e={load:function(e,t){we._as(fe),we._s=!1,we.clearInstruments(31);var a={patterns:[],_ak:1},n=4;a.typeId=e._v(4,1080),a.title=e._v(20,0),"2CHN"===a.typeId&&(n=2),"6CHN"===a.typeId&&(n=6),"8CHN"===a.typeId&&(n=8),"10CH"===a.typeId&&(n=10),"12CH"===a.typeId&&(n=12),"14CH"===a.typeId&&(n=14),"16CH"===a.typeId&&(n=16),"18CH"===a.typeId&&(n=18),"20CH"===a.typeId&&(n=20),"22CH"===a.typeId&&(n=22),"24CH"===a.typeId&&(n=24),"26CH"===a.typeId&&(n=26),"28CH"===a.typeId&&(n=28),"30CH"===a.typeId&&(n=30),"32CH"===a.typeId&&(n=32),a.channels=n;var r=0;for(c=1;c<=31;++c){var o=e._v(22),i=e._g(),s=xe();s._a=o,s.sample.length=s.sample.realLen=i<<1;var u=e._e();7<u&&(u-=16),s.setFineTune(u),s.sample.volume=e._e(),s.sample.loop.start=e._g()<<1,s.sample.loop.length=e._g()<<1,s.sample.loop.enabled=2<s.sample.loop.length,s.sample.loop.type=A,s.pointer=r,r+=s.sample.length,s.setSampleIndex(0),we.setInstrument(c,s)}a._us=we._ts(),e.goto(950),a.length=e._e(),e.jump(1);for(var _=[],l=0,c=0;c<128;++c)_[c]=e._e(),l<_[c]&&(l=_[c]);for(a.patternTable=_,e.goto(1084),c=0;c<=l;++c){for(var f=[],p=0;p<64;p++){var d,m=[];for(d=0;d<n;d++){var v=Ce(),h=e.readUint();v.setPeriod(h>>16&4095),v.effect=h>>8&15,v._u=h>>24&240|h>>12&15,v._i=255&h,m.push(v)}for(d=n;d<we.getTrackCount();d++)m.push(Ce());f.push(m)}a.patterns.push(f)}var g=[];for(c=1;c<=31;c++)if(s=we._t(c)){var b=s.sample.length;for(2<s.sample.loop.length&&de.unrollShortLoops&&s.sample.loop.length<1e3&&(b=Math.min(b,s.sample.loop.start+s.sample.loop.length),s.sample.length=b),j=0;j<b;j++){var y=e.readByte();j<2&&(y=0),s.sample.data.push(y/127)}if((de.unrollShortLoops||de.unrollLoops)&&2<s.sample.loop.length){var T=Math.ceil(4e4/s.sample.loop.length)+1;de.unrollLoops||(T=0);var k=!1,w=0;de.unrollShortLoops&&s.sample.loop.length<1600&&(T=Math.floor(1e3/s.sample.loop.length),k=!0);for(var P=0;P<T;P++){var x=s.sample.loop.start,C=x+s.sample.loop.length;for(j=x;j<C;j++)s.sample.data.push(s.sample.data[j]);w+=s.sample.loop.length}k&&w&&(s.sample.loop.length+=w,s.sample.length+=w)}g.push({label:c+" "+s._a,data:c})}return me._o(oe,g),a}};return e},m=function(){var e={load:function(e,t){we._as(fe),we._s=!1,we.clearInstruments(15);var a={patterns:[],_ak:1};a.typeId="ST",a.channels=4,a.title=e._v(20,0);var n=0;for(_=1;_<=15;++_){var r=e._v(22),o=e._g(),i=xe();i._a=r,i.sample.length=i.realLen=o<<1,i.sample.volume=e._g(),i.setFineTune(0),i.sample.loop.start=e._g(),i.sample.loop.length=e._g()<<1,i.sample.loop.enabled=2<i.sample.loop.length,i.sample.loop.type=A,i.pointer=n,n+=i.sample.length,i.setSampleIndex(0),we.setInstrument(_,i)}a._us=we._ts(),e.goto(470),a.length=e._e(),a.speed=e._e();for(var s=[],u=0,_=0;_<128;++_)s[_]=e._e(),u<s[_]&&(u=s[_]);for(a.patternTable=s,e.goto(600),_=0;_<=u;++_){for(var l=[],c=0;c<64;c++){var f,p=[];for(f=0;f<4;f++){var d={},m=e.readUint();d._b=m>>16&4095,d.effect=m>>8&15,d._u=m>>24&240|m>>12&15,d._i=255&m,p.push(d)}for(f=4;f<we.getTrackCount();f++)p.push({note:0,effect:0,_u:0,_i:0});l.push(p)}a.patterns.push(l)}var v=[];for(_=1;_<=15;_++)if(i=we._t(_)){var h=i.sample.length;for(j=0;j<h;j++){var g=e.readByte();j<2&&(g=0),i.sample.data.push(g/127)}v.push({label:_+" "+i._a,data:_})}return me._o(oe,v),a}};return e},v=function(){var C={load:function(e,t){function a(e){for(e.points=[],g=0;g<12;g++)e.points.push(e.raw.slice(2*g,2*g+2));return 1&e.type&&(e.enabled=!0),2&e.type&&(e.sustain=!0),4&e.type&&(e.loop=!0),e}we._as(pe),we.clearInstruments(1);var n={},r={patterns:[],_us:[]};e._am=!0,e.goto(17),r.title=e._v(20),e.jump(1),n.trackerName=e._v(20),n.trackerVersion=e.readByte(),n.trackerVersion=e.readByte()+"."+n.trackerVersion,n.headerSize=e.readDWord(),n.songlength=e._g(),n._ak=e._g(),n.numberOfChannels=e._g(),n.numberOfPatterns=e._g(),n.numberOfInstruments=e._g(),n.flags=e._g(),we._s=n.flags%2==1,n.defaultTempo=e._g(),n.defaultBPM=e._g();for(var o=[],i=0,s=0;s<n.songlength;++s)o[s]=e._e(),i<o[s]&&(i=o[s]);r.patternTable=o,r.length=n.songlength,r.channels=n.numberOfChannels,r._ak=n._ak+1;var u=60+n.headerSize;for(e.goto(u),s=0;s<n.numberOfPatterns;s++){var _=[],l={};l.headerSize=e.readDWord(),l.packingType=e._e(),l.patternLength=e._g(),l.patternSize=e._g(),e.goto(u+=l.headerSize);for(var c=0;c<l.patternLength;c++){var f,p=[];for(f=0;f<n.numberOfChannels;f++){var d=Ce(),m=e._e();128&m?(1&m&&d.setIndex(e._e()),2&m&&(d._u=e._e()),4&m&&(d.volumeEffect=e._e()),8&m&&(d.effect=e._e()),16&m&&(d._i=e._e())):(d.setIndex(m),d._u=e._e(),d.volumeEffect=e._e(),d.effect=e._e(),d._i=e._e()),p.push(d)}_.push(p)}e.goto(u+=l.patternSize),r.patterns.push(_)}var v=[];for(s=1;s<=n.numberOfInstruments;++s){var h=xe();try{if(h.filePosition=e.index,h.headerSize=e.readDWord(),h._a=e._v(22),h.type=e._e(),h._aj=e._g(),h.samples=[],(h._al=0)<h._aj){h._al=e.readDWord(),h._al=Math.max(h._al,40),200<h._al&&(h._al=40);for(var g=0;g<96;g++)h._z.push(e._e());for(g=0;g<24;g++)h._c.raw.push(e._g());for(g=0;g<24;g++)h._d.raw.push(e._g());h._c.count=e._e(),h._d.count=e._e(),h._c._ag=e._e(),h._c._w=e._e(),h._c._ai=e._e(),h._d._ag=e._e(),h._d._w=e._e(),h._d._ai=e._e(),h._c.type=e._e(),h._d.type=e._e(),h._p.type=e._e(),h._p.sweep=e._e(),h._p.depth=Math.min(e._e(),15),h._p.rate=e._e(),h.fadeout=e._g(),h.reserved=e._g(),h._c=a(h._c),h._d=a(h._d)}}catch(e){}if(e.goto(u+=h.headerSize),0===h._aj){var b=M();h.samples.push(b)}else{if(e.isEOF(1))break;for(var y=0;y<h._aj;y++)(b=M()).length=e.readDWord(),b.loop.start=e.readDWord(),b.loop.length=e.readDWord(),b.volume=e._e(),b.finetuneX=e.readByte(),b.type=e._e(),b.panning=e._e()-128,b.relativeNote=e.readByte(),b.reserved=e.readByte(),b._a=e._v(22),b.bits=8,h.samples.push(b),e.goto(u+=h._al);for(y=0;y<h._aj;y++)if((b=h.samples[y]).length){u+=b.length,16&b.type&&(b.bits=16,b.type^=16,b.length>>=1,b.loop.start>>=1,b.loop.length>>=1),b.loop.type=b.type||0,b.loop.enabled=!!b.loop.type;var T=b.length,k=0;if(16===b.bits)for(var w=0;w<T;w++){var P=e.readShort()+k;P<-32768?P+=65536:32767<P&&(P-=65536),b.data.push((k=P)/32768)}else for(w=0;w<T;w++)(P=e.readByte()+k)<-128?P+=256:127<P&&(P-=256),b.data.push((k=P)/127);if(b.loop.type===F){var x=b.data.slice(b.loop.start,b.loop.start+b.loop.length);b.data=b.data.slice(0,b.loop.start+b.loop.length),b.data=b.data.concat(x.reverse()),b.loop.length=2*b.loop.length,b.length=b.loop.start+b.loop.length}e.goto(u)}}h.setSampleIndex(0),we.setInstrument(s,h),v.push({label:s+" "+h._a,data:s})}return me._o(oe,v),r._us=we._ts(),we.setBPM(n.defaultBPM),we._x(n.defaultTempo),C.validate(r),r},validate:function(e){function r(e,t){var a=!0;if(e.points&&e.points[0])if(0===e.points[0][0])for(var n=0,r=1;r<e.count;r++){var o=e.points[r];o&&n<o[0]?n=o[0]:a=!1}else a=!1;else a=!1;return a?e:"volume"===t?{raw:[],enabled:!1,points:[[0,48],[10,64],[20,40],[30,18],[40,28],[50,18]],count:6}:{raw:[],enabled:!1,points:[[0,32],[20,40],[40,24],[60,32],[80,32]],count:5}}e._us.forEach(function(e){e._c=r(e._c,"volume"),e._d=r(e._d,"panning");for(var t=e.samples.length-1,a=0,n=e._z.length;a<n;a++)e._z[a]=Math.min(e._z[a],t)})}};return C},xe=function(){function i(e,t,a){var n=we.getProperties().tickTime,r=e.sustain?e._ag+1:e.count;e._w=Math.min(e._w,e.count-1),e._ai=Math.min(e._ai,e.count-1);var o=e.loop&&e._w<e._ai;e.sustain&&e._ag<=e._w&&(o=!1),o&&(r=e._ai+1);var i=0;if(t.gain)var s=t.gain,u=0,_=64;else s=t.pan,_=u=32;s.setValueAtTime((e.points[0][1]-u)/_,a);for(var l=1;l<r;l++){var c=e.points[l];s.linearRampToValueAtTime((c[1]-u)/_,a+(i=c[0]*n))}return!!o&&p.scheduleEnvelopeLoop(t,a,2,i)}var p={type:"sample",_a:"",_q:0,sampleIndex:-1,fadeout:128,data:[]};return p.samples=[M()],p.sample=p.samples[0],p._c={raw:[],enabled:!1,points:[[0,48],[10,64],[20,40],[30,18],[40,28],[50,18]],count:6},p._d={raw:[],enabled:!1,points:[[0,32],[20,40],[40,24],[60,32],[80,32]],count:5},p._p={},p._z=[],p.play=function(e,t,a,n,r,o){return we._j()&&(t=p._an(e)),ve.playSample(p._q,t,a,n,r,o,e)},p.noteOn=function(e){var t,a,n={};if(p._c.enabled){t=ve.context.createGain();var r=p._c,o=i(r,t,e);o&&(n.volume=e+o)}return p._d.enabled&&ve.usePanning&&(a=ve.context.createStereoPanner(),(o=i(r=p._d,a,e))&&(n.panning=e+o)),p._p.rate&&p._p.depth&&(n.ticks=0,n._p=e,n._pFunction=p._ae()),{volume:t,panning:a,scheduled:n}},p.noteOff=function(e,t){function a(){t.volume.gain.cancelScheduledValues(e),t.volumeFadeOut.gain.cancelScheduledValues(e),t._c&&t._c.gain.cancelScheduledValues(e),t._d&&t._d.pan.cancelScheduledValues(e),t.scheduled=void 0}if(t&&t.volume){if(we._j()){var n=we.getProperties().tickTime;if(p._c.enabled){if(p._c.sustain&&t._c){a();var r=0,o=p._c.points[p._c._ag];o&&(r=o[0]*n);for(var i=p._c._ag;i<p._c.count;i++){var s=p._c.points[i];s&&t._c.gain.linearRampToValueAtTime(s[1]/64,e+s[0]*n-r)}}if(p.fadeout)t.volumeFadeOut.gain.linearRampToValueAtTime(0,e+65536/p.fadeout*n/2)}else a(),t.volumeFadeOut.gain.linearRampToValueAtTime(0,e+.1);if(p._d.enabled&&ve.usePanning&&t._d)for(r=0,(o=p._d.points[p._d._ag])&&(r=o[0]*n),i=p._d._ag;i<p._d.count;i++)(s=p._d.points[i])&&t._d.pan.linearRampToValueAtTime((s[1]-32)/32,e+s[0]*n-r);return 100}if(a(),!t.isKey||!t.volume)return 0;t.volume.gain.linearRampToValueAtTime(0,e+.5)}},p.scheduleEnvelopeLoop=function(e,t,a,n){n=n||0;var r=we.getProperties().tickTime;if(e.gain)var o=p._c,i=e.gain,s=0,u=64;else o=p._d,i=e.pan,u=s=32;var _=o.points[o._w],l=_[0];if(o.loop&&o._w<o._ai)for(;n<a;)for(var c=n,f=o._w;f<=o._ai;f++)i.linearRampToValueAtTime(((_=o.points[f])[1]-s)/u,t+(n=c+(_[0]-l)*r));return n},p.scheduleAutoVibrato=function(e,t){var a=0;e.scheduled.ticks=e.scheduled.ticks||0;var n,r,o,i,s=we.getProperties().tickTime,u=-p._p.rate/40,_=p._p.depth/8;for(we._s&&(_*=4),e.source&&(n=e.startPeriod,r=e.scheduled._pFunction||ve._r.sine,o=e.scheduled._p||ve.context.currentTime,i=0);a<t;){if(a+=s,n){var l=1;p._p.sweep&&e.scheduled.ticks<p._p.sweep&&(l=1-(p._p.sweep-e.scheduled.ticks)/p._p.sweep);var c=r(n,e.scheduled.ticks,u,_*l);we.setPeriodAtTime(e,c,o+i*s),i++}e.scheduled.ticks++}return a},p._ae=function(){switch(p._p.type){case 1:return ve._r.square;case 2:return ve._r.saw;case 3:return ve._r.sawInverse}return ve._r.sine},p.resetVolume=function(e,t){if(t.volumeFadeOut&&(t.volumeFadeOut.gain.cancelScheduledValues(e),t.volumeFadeOut.gain.setValueAtTime(1,e)),t._c){t._c.gain.cancelScheduledValues(e);var a=we.getProperties().tickTime,n=p._c.sustain?p._c._ag+1:p._c.count;t._c.gain.setValueAtTime(p._c.points[0][1]/64,e);for(var r=1;r<n;r++){var o=p._c.points[r];t._c.gain.linearRampToValueAtTime(o[1]/64,e+o[0]*a)}}},p._af=function(){return we._j()?p.sample.finetuneX:p.sample.finetune},p.setFineTune=function(e){we._j()?(p.sample.finetuneX=e,p.sample.finetune=e>>4):(7<e&&(e-=15),p.sample.finetune=e,p.sample.finetuneX=e<<4)},p._an=function(e,t){var a=0;return we._s?(a=7680-64*(e-1),t&&(a-=p._af()/2)):(a=Te[e]._b,t&&p._af()&&(a=ve._ap(e,p._af()))),a},p.setSampleForNoteIndex=function(e){var t=p._z[e-1];t!==p.sampleIndex&&"number"==typeof t&&p.setSampleIndex(t)},p.setSampleIndex=function(e){p.sampleIndex!==e&&(p.sample=p.samples[e],p.sampleIndex=e,me._o(a,p._q))},p.hasSamples=function(){for(var e=0,t=p.samples.length;e<t;e++)if(p.samples[e].length)return!0},p.hasVibrato=function(){return p._p.rate&&p._p.depth},p},M=function(){var r={data:[],length:0,_a:"",bits:8,volume:64,finetune:0,finetuneX:0,panning:0,relativeNote:0,loop:{enabled:!1,start:0,length:0,type:0},check:function(){for(var e=0,t=0,a=0,n=r.data.length;a<n;a++)e=Math.min(e,r.data[a]),t=Math.max(t,r.data[a]);return{min:e,max:t}}};return r},Ce=function(){var a={_b:0,index:0,effect:0,_u:0,_i:0,volumeEffect:0,setPeriod:function(e){a._b=e,a.index=ke[e]||0},setIndex:function(e){var t=Te[a.index=e];t?(a._b=t._k||t._b,1===a._b&&(a._b=0)):a._b=0},clear:function(){a._u=0,a._b=0,a.effect=0,a._i=0,a.index=0,a.volumeEffect=0},duplicate:function(){return{_u:a._u,_b:a._b,effect:a.effect,_i:a._i,volumeEffect:a.volumeEffect,note:a.index}},populate:function(e){a._u=e._u||0,a._b=e._b||0,a.effect=e.effect||0,a._i=e._i||0,a.volumeEffect=e.volumeEffect||0,a.index=e.note||e.index||0}};return a};return{init:we.init,load:we.load,playSong:we.playSong,stop:we.stop,togglePlay:we.togglePlay,isPlaying:we.isPlaying,getTrackCount:we.getTrackCount,getSong:we.getSong,getStateAtTime:we.getStateAtTime,setCurrentSongPosition:we.setCurrentSongPosition,audio:ve}}();